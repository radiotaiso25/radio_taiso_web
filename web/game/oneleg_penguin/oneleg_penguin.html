<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>ç‰‡è¶³ãƒšãƒ³ã‚®ãƒ³ãƒãƒ©ãƒ³ã‚¹ã‚²ãƒ¼ãƒ </title>
  <style>
    body {
      font-family: "YuGothic", "Hiragino Kaku Gothic ProN", sans-serif;
      background: #f5f9ff;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    header {
      width: 100%;
      padding: 16px 24px;
      box-sizing: border-box;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #ffffff;
      border-bottom: 1px solid #dde6f5;
    }
    header h1 {
      margin: 0;
      font-size: 20px;
      color: #1a4c8a;
    }
    header button {
      padding: 6px 14px;
      font-size: 13px;
      border-radius: 999px;
      border: none;
      background: #eee;
      cursor: pointer;
    }
    .container {
      margin-top: 20px;
      max-width: 900px;
      width: 100%;
      padding: 0 16px 40px;
      box-sizing: border-box;
      text-align: center;
    }
    .description {
      background: #ffffff;
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
      font-size: 14px;
      line-height: 1.7;
      text-align: left;
      margin-bottom: 16px;
    }
    .description ul {
      padding-left: 20px;
      margin: 4px 0 0 0;
    }
    .info-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 12px 0 8px;
      font-size: 14px;
    }
    .info-item {
      background: #ffffff;
      border-radius: 999px;
      padding: 6px 14px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }
    .info-label {
      color: #555;
    }
    .info-value {
      font-weight: bold;
      color: #1a4c8a;
      min-width: 36px;
      text-align: right;
    }

    .game-area {
      position: relative;
      margin: 0 auto;
      margin-top: 10px;
      width: 500px;
      height: 260px;
      background: #e3f2fd;
      border-radius: 18px;
      box-shadow: 0 6px 16px rgba(0,0,0,0.12);
      overflow: hidden;
    }

    .ground {
      position: absolute;
      bottom: 40px;
      left: 0;
      right: 0;
      height: 6px;
      background: #bbdefb;
    }

    .safe-zone {
      position: absolute;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      width: 160px;
      height: 80px;
      border-radius: 80px;
      border: 2px dashed #1e88e5;
      box-sizing: border-box;
    }

    .penguin {
      position: absolute;
      bottom: 46px;
      left: 50%;
      width: 70px;
      height: 120px;
      margin-left: -35px;
      transform-origin: 50% 8%;
    }

    .penguin-body {
      position: absolute;
      bottom: 0;
      left: 50%;
      width: 60px;
      height: 90px;
      margin-left: -30px;
      border-radius: 30px 30px 24px 24px;
      background: #90caf9;
    }

    .penguin-belly {
      position: absolute;
      bottom: 10px;
      left: 50%;
      width: 40px;
      height: 60px;
      margin-left: -20px;
      border-radius: 20px;
      background: #e3f2fd;
    }

    .penguin-head {
      position: absolute;
      bottom: 82px;
      left: 50%;
      width: 52px;
      height: 48px;
      margin-left: -26px;
      border-radius: 26px;
      background: #64b5f6;
    }

    .penguin-eye {
      position: absolute;
      top: 14px;
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #212121;
    }
    .penguin-eye.left { left: 16px; }
    .penguin-eye.right { right: 16px; }

    .penguin-beak {
      position: absolute;
      bottom: 8px;
      left: 50%;
      width: 16px;
      height: 10px;
      margin-left: -8px;
      border-radius: 0 0 8px 8px;
      background: #ffca28;
    }

    .penguin-foot {
      position: absolute;
      bottom: -6px;
      left: 50%;
      width: 38px;
      height: 10px;
      margin-left: -19px;
      border-radius: 12px;
      background: #ffb74d;
    }

    .hint {
      font-size: 13px;
      color: #666;
      margin-top: 8px;
    }
    .button-row {
      margin-top: 16px;
      display: flex;
      justify-content: center;
      gap: 12px;
    }
    .btn-main {
      padding: 10px 22px;
      font-size: 15px;
      border-radius: 999px;
      border: none;
      background: #4caf50;
      color: #fff;
      cursor: pointer;
    }
    .btn-sub {
      padding: 8px 18px;
      font-size: 14px;
      border-radius: 999px;
      border: none;
      background: #9e9e9e;
      color: #fff;
      cursor: pointer;
    }
    .result-message {
      margin-top: 12px;
      font-size: 14px;
      font-weight: bold;
      color: #d84315;
    }
  </style>
</head>
<body>
  <header>
    <h1>ğŸ§ ç‰‡è¶³ãƒšãƒ³ã‚®ãƒ³ãƒãƒ©ãƒ³ã‚¹</h1>
    <button onclick="location.href='/'">ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã¸æˆ»ã‚‹</button>
  </header>

  <div class="container">
    <div class="description">
      <b>ã€ã‚²ãƒ¼ãƒ ã®ç›®çš„ã€‘</b><br>
      ç‰‡è¶³ç«‹ã¡ã§ãã‚‰ãã‚‰ã—ãªã„ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã€ãƒšãƒ³ã‚®ãƒ³ã®ãƒãƒ©ãƒ³ã‚¹ã‚’ä¿ã¤ã‚²ãƒ¼ãƒ ã§ã™ã€‚<br>
      å°†æ¥ã¯ã€Œç‰‡è¶³ç«‹ã¡ä¸­ã®ä½“ã®å‚¾ãã€ã‚„ã€Œé‡å¿ƒã®æºã‚Œå…·åˆã€ã§æ“ä½œã™ã‚‹æƒ³å®šã§ã™ãŒã€ã¾ãšã¯ã‚­ãƒ¼æ“ä½œã§è©¦ã›ã¾ã™ã€‚<br>
      <ul>
        <li>å·¦å³ã‚­ãƒ¼ï¼ˆâ† â†’ï¼‰ã§ãƒšãƒ³ã‚®ãƒ³ã‚’å°‘ã—å‚¾ã‘ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹</li>
        <li>é’ã„ã‚¾ãƒ¼ãƒ³ã®ä¸­ã«ã§ãã‚‹ã ã‘é•·ãåã¾ã‚‹ã¨é«˜ã‚¹ã‚³ã‚¢</li>
        <li>åˆ¶é™æ™‚é–“ï¼š<b>20ç§’</b>ï¼ˆçŸ­ã‚ã®ãƒ†ã‚¹ãƒˆç”¨ï¼‰</li>
      </ul>
    </div>

    <div class="info-bar">
      <div class="info-item">
        <span class="info-label">å®‰å®šæ™‚é–“</span>
        <span id="score" class="info-value">0</span>
        <span>ç§’</span>
      </div>
      <div class="info-item">
        <span class="info-label">æ®‹ã‚Šæ™‚é–“</span>
        <span id="time" class="info-value">20</span>
        <span>ç§’</span>
      </div>
    </div>

    <div class="game-area">
      <div class="ground"></div>
      <div class="safe-zone"></div>
      <div class="penguin" id="penguin">
        <div class="penguin-body"></div>
        <div class="penguin-belly"></div>
        <div class="penguin-head">
          <div class="penguin-eye left"></div>
          <div class="penguin-eye right"></div>
          <div class="penguin-beak"></div>
        </div>
        <div class="penguin-foot"></div>
      </div>
    </div>

    <div class="hint">
      ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã® <b>â† â†’</b> ã‚­ãƒ¼ã§ã€ä½“ã‚’å°‘ã—å‚¾ã‘ãªãŒã‚‰ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚<br>
      å°†æ¥ã¯ã€Œç‰‡è¶³ç«‹ã¡ä¸­ã®ä¸ŠåŠèº«ã®è§’åº¦ã€ã‚„ã€Œè¶³é¦–ã®å‚¾ãã€ã‹ã‚‰ã“ã®æºã‚Œã‚’æ±ºã‚ã‚‹å½¢ã«å·®ã—æ›¿ãˆã§ãã¾ã™ã€‚
    </div>

    <div class="button-row">
      <button class="btn-main" id="startBtn">â–¶ ã‚²ãƒ¼ãƒ é–‹å§‹</button>
      <button class="btn-sub" onclick="location.href='/record'">ãƒ©ã‚¸ã‚ªä½“æ“ã«æˆ»ã‚‹</button>
    </div>

    <div id="resultMessage" class="result-message"></div>
  </div>

  <script>
    const penguin = document.getElementById("penguin");
    const scoreSpan = document.getElementById("score");
    const timeSpan = document.getElementById("time");
    const startBtn = document.getElementById("startBtn");
    const resultMessage = document.getElementById("resultMessage");

    let angle = 0;           // å‚¾ãï¼ˆ-20 ï½ +20åº¦ï¼‰
    let velocity = 0;        // æºã‚Œé€Ÿåº¦
    let isPlaying = false;
    let timeLeft = 20;
    let timerId = null;
    let insideTime = 0;      // ã‚»ãƒ¼ãƒ•ã‚¾ãƒ¼ãƒ³å†…ã®æ™‚é–“[s]
    let lastTimestamp = null;

    function updateVisual() {
      penguin.style.transform = `translateX(-50%) rotate(${angle}deg)`;
    }

    document.addEventListener("keydown", (e) => {
      if (!isPlaying) return;
      const step = 2;
      if (e.key === "ArrowLeft") {
        angle -= step;
      } else if (e.key === "ArrowRight") {
        angle += step;
      }
      angle = Math.max(-25, Math.min(25, angle));
      updateVisual();
    });

    function loop(timestamp) {
      if (!isPlaying) return;
      if (lastTimestamp == null) lastTimestamp = timestamp;
      const dt = (timestamp - lastTimestamp) / 1000.0;
      lastTimestamp = timestamp;

      // é¢¨ã®ã‚ˆã†ãªå¤–ä¹±
      const randomForce = (Math.random() - 0.5) * 0.3;
      velocity += randomForce;
      velocity *= 0.985;
      angle += velocity;
      angle = Math.max(-30, Math.min(30, angle));
      updateVisual();

      // ã‚»ãƒ¼ãƒ•ã‚¾ãƒ¼ãƒ³ = -10 ~ +10åº¦ ã¨ä»®å®š
      if (Math.abs(angle) <= 10) {
        insideTime += dt;
      }

      requestAnimationFrame(loop);
    }

    function startGame() {
      if (isPlaying) return;
      isPlaying = true;
      angle = 0;
      velocity = 0;
      timeLeft = 20;
      insideTime = 0;
      lastTimestamp = null;
      scoreSpan.textContent = "0";
      timeSpan.textContent = timeLeft.toString();
      resultMessage.textContent = "";
      updateVisual();

      startBtn.textContent = "ãƒ—ãƒ¬ã‚¤ä¸­â€¦";
      startBtn.disabled = true;

      requestAnimationFrame(loop);

      timerId = setInterval(() => {
        timeLeft -= 1;
        timeSpan.textContent = timeLeft.toString();

        if (timeLeft <= 0) {
          endGame();
        }
      }, 1000);
    }

    function endGame() {
      if (!isPlaying) return;
      isPlaying = false;
      clearInterval(timerId);

      const scoreSec = Math.round(insideTime);
      scoreSpan.textContent = scoreSec.toString();

      startBtn.textContent = "ã‚‚ã†ä¸€åº¦éŠã¶";
      startBtn.disabled = false;

      if (scoreSec >= 15) {
        resultMessage.textContent = "ã¨ã¦ã‚‚å®‰å®šã—ã¦ã„ã¾ã—ãŸï¼ç‰‡è¶³ãƒãƒ©ãƒ³ã‚¹ã°ã£ã¡ã‚Šã§ã™ ğŸ‘";
      } else if (scoreSec >= 8) {
        resultMessage.textContent = "è‰¯ã„æ„Ÿã˜ã§ã™ã€‚ç„¡ç†ã®ãªã„ç¯„å›²ã§ã€å°‘ã—ãšã¤ãƒãƒ©ãƒ³ã‚¹æ™‚é–“ã‚’ä¼¸ã°ã—ã¦ã„ãã¾ã—ã‚‡ã†ã€‚";
      } else {
        resultMessage.textContent = "ä»Šæ—¥ã¯å°‘ã—æºã‚ŒãŒå¤§ãã‚ã§ã—ãŸã€‚æ¤…å­ã‚„å£ã‚’ãã°ã«ç½®ã„ã¦ã€å®‰å…¨ãªç¯„å›²ã§ç·´ç¿’ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚";
      }
    }

    startBtn.addEventListener("click", startGame);
    updateVisual();
  </script>
</body>
</html>
